# دليل لوحة التحكم الشاملة

## نظرة عامة

تم إنشاء لوحة تحكم شاملة لإدارة جميع جوانب الموقع، تتضمن:

### المميزات الرئيسية:

1. **إدارة المشاريع** - إضافة وتعديل وحذف المشاريع
2. **متابعة طلبات العملاء** - متابعة طلبات العملاء لكل مشروع منفصل
3. **إدارة العملاء** - إدارة قاعدة بيانات العملاء
4. **إدارة الوكلاء** - إدارة وكلاء المبيعات
5. **إدارة المحتوى** - تعديل جميع النصوص والمحتوى في الموقع
6. **إدارة الصور** - رفع وتعديل الصور
7. **إدارة الإحصائيات** - تعديل الإحصائيات المعروضة (المساحات، عدد البنايات، إلخ)
8. **إدارة الموظفين** - إضافة وتعديل الموظفين والصلاحيات
9. **التواصل العام** - إدارة رسائل التواصل من الموقع

## تسجيل الدخول

### الطريقة الأولى: استخدام بيانات البيئة
- البريد: `admin@asawer.om`
- كلمة المرور: `Asawer123!@#`

### الطريقة الثانية: استخدام قاعدة البيانات
1. قم بإنشاء موظف جديد من صفحة "الموظفين"
2. استخدم البريد الإلكتروني وكلمة المرور المسجلة

## الصفحات المتاحة

### 1. لوحة التحكم الرئيسية (`/admin/dashboard`)
- عرض إحصائيات سريعة
- آخر العملاء
- نظرة عامة على المشاريع

### 2. إدارة المشاريع (`/admin/projects`)
- إضافة مشروع جديد
- تعديل المشاريع الموجودة
- حذف المشاريع
- إدارة تفاصيل المشروع (الاسم، السعر، الحالة، النوع)

### 3. متابعة طلبات العملاء (`/admin/project-leads`)
- عرض طلبات العملاء مجمعة حسب المشروع
- تغيير حالة الطلب
- إضافة ملاحظات لكل عميل
- عرض تفاصيل كاملة لكل طلب

### 4. إدارة العملاء (`/admin/leads`)
- عرض جميع العملاء
- إضافة عميل جديد
- تعديل بيانات العميل
- تغيير حالة العميل

### 5. إدارة الوكلاء (`/admin/agents`)
- إدارة وكلاء المبيعات
- تفعيل/إلغاء تفعيل الوكيل

### 6. إدارة المحتوى (`/admin/content`)
- تعديل جميع النصوص في الموقع
- البحث في المحتوى
- تصفية حسب القسم
- دعم النصوص العادية، HTML، و Markdown

**أقسام المحتوى:**
- `hero` - قسم البطل الرئيسي
- `about` - قسم من نحن
- `projects` - قسم المشاريع
- `team` - قسم الفريق
- `contact` - قسم التواصل
- `footer` - التذييل
- `stats` - الإحصائيات
- `news` - الأخبار

### 7. إدارة الصور (`/admin/images`)
- رفع صور جديدة
- تعديل معلومات الصور
- حذف الصور
- تصنيف الصور حسب الفئة
- ربط الصور بالمشاريع

**فئات الصور:**
- `hero` - صور البطل الرئيسي
- `project` - صور المشاريع
- `team` - صور الفريق
- `gallery` - معرض الصور
- `about` - صور قسم من نحن
- `logo` - الشعارات
- `other` - أخرى

### 8. إدارة الإحصائيات (`/admin/statistics`)
- إضافة إحصائية جديدة
- تعديل القيم (المساحات، عدد البنايات، إلخ)
- تفعيل/إلغاء تفعيل الإحصائية
- ترتيب عرض الإحصائيات

**ملاحظة:** الإحصائيات الخاصة بتفاعل العملاء (مثل عدد الزيارات) يتم حسابها تلقائياً ولا تحتاج تعديل.

### 9. إدارة الموظفين (`/admin/staff`)
- إضافة موظف جديد
- تعديل بيانات الموظف
- تغيير كلمة المرور
- تحديد الصلاحيات (محرر، مدير، مدير عام)
- تفعيل/إلغاء تفعيل الموظف

**الأدوار:**
- `editor` - محرر: يمكنه تعديل المحتوى فقط
- `admin` - مدير: يمكنه إدارة جميع المحتويات
- `super_admin` - مدير عام: صلاحيات كاملة

### 10. التواصل العام (`/admin/contact`)
- عرض جميع رسائل التواصل
- تصفية حسب الحالة (جديد، مقروء، تم الرد، مؤرشف)
- الرد على الرسائل
- أرشفة الرسائل

## قاعدة البيانات

### الجداول الجديدة:

1. **staff** - الموظفين
2. **content** - المحتوى القابل للتعديل
3. **images** - الصور
4. **statistics** - الإحصائيات القابلة للتعديل
5. **auto_statistics** - الإحصائيات التلقائية (لتفاعل العملاء)
6. **contact_messages** - رسائل التواصل

### تشغيل قاعدة البيانات:

1. افتح Supabase Dashboard
2. اذهب إلى SQL Editor
3. قم بتشغيل ملف `src/lib/database-schema-extended.sql`

## التثبيت

### 1. تثبيت الحزم المطلوبة:

```bash
npm install bcryptjs
npm install --save-dev @types/bcryptjs
```

### 2. إعداد متغيرات البيئة:

أضف إلى ملف `.env.local`:

```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
ADMIN_EMAIL=admin@asawer.om
ADMIN_PASSWORD=Asawer123!@#
ADMIN_SESSION_SECRET=your-secret-key-change-in-production
```

### 3. تشغيل قاعدة البيانات:

قم بتشغيل ملف SQL الموجود في `src/lib/database-schema-extended.sql`

## الأمان

- جميع الصفحات محمية بنظام المصادقة
- كلمات المرور مشفرة باستخدام bcrypt
- الجلسات محمية بـ HTTP-only cookies
- التحقق من الصلاحيات في كل عملية

## ملاحظات مهمة

1. **رفع الصور:** حالياً يستخدم النظام روابط مباشرة. في الإنتاج، يجب استخدام خدمة تخزين مثل AWS S3 أو Cloudinary.

2. **الإحصائيات التلقائية:** يتم حسابها تلقائياً عند تفاعل العملاء مع الموقع. لا تحتاج تعديل يدوي.

3. **النسخ الاحتياطي:** يُنصح بعمل نسخ احتياطي منتظم لقاعدة البيانات.

4. **الأداء:** استخدم الفلاتر والبحث لتسهيل إدارة البيانات الكبيرة.

## الدعم

للمساعدة أو الإبلاغ عن مشاكل، يرجى التواصل مع فريق التطوير.

